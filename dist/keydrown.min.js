/*! keydrown - v1.2.2 - 2016-09-24 - http://jeremyckahn.github.com/keydrown */
!function(a){var b=function(){var b={};b.forEach=function(a,b){var c;for(c in a)a.hasOwnProperty(c)&&b(a[c],c)};var c=b.forEach;b.getTranspose=function(a){var b={};return c(a,function(a,c){b[a]=c}),b},b.indexOf=function(a,b){if(a.indexOf)return a.indexOf(b);var c,d=a.length;for(c=0;c<d;c++)if(a[c]===b)return c;return-1};var d=b.indexOf;return b.pushUnique=function(a,b){return d(a,b)===-1&&(a.push(b),!0)},b.removeValue=function(a,b){var c=d(a,b);if(c!==-1)return a.splice(c,1)[0]},b.documentOn=function(b,c){a.addEventListener?a.addEventListener(b,c,!1):document.attachEvent&&document.attachEvent("on"+b,c)},b.requestAnimationFrame=function(){return a.requestAnimationFrame||a.webkitRequestAnimationFrame||a.mozRequestAnimationFrame||function(b){a.setTimeout(b,1e3/60)}}(),b.noop=function(){},b}(),c={0:48,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,ENTER:13,SHIFT:16,ESC:27,SPACE:32,LEFT:37,UP:38,RIGHT:39,DOWN:40,BACKSPACE:8,DELETE:46},d=b.getTranspose(c),e=[],f=function(){"use strict";function a(a){this.keyCode=a,this.cachedKeypressEvent=null}function c(a,b,c,d){c?a[b]=c:a[b](d)}return a.prototype._downHandler=b.noop,a.prototype._upHandler=b.noop,a.prototype._pressHandler=b.noop,a.prototype.isDown=function(){return b.indexOf(e,this.keyCode)!==-1},a.prototype.down=function(a){c(this,"_downHandler",a,this.cachedKeypressEvent)},a.prototype.up=function(a,b){c(this,"_upHandler",a,b)},a.prototype.press=function(a,b){this.cachedKeypressEvent=b,c(this,"_pressHandler",a,b)},a.prototype.unbindDown=function(){this._downHandler=b.noop},a.prototype.unbindUp=function(){this._upHandler=b.noop},a.prototype.unbindPress=function(){this._pressHandler=b.noop},a}(),g=function(e){"use strict";var g={};g.Key=f;var h=!1,i=Date.now?Date.now:function(){return+new Date},j=i();return g.tick=function(){var a,b=e.length;for(a=0;a<b;a++){var c=e[a],f=d[c];f&&g[f].down()}},g.run=function(c){h=!0;var d=i(),e=d-j;b.requestAnimationFrame.call(a,function(){h&&(g.run(c),c(e,d))}),j=d},g.stop=function(){h=!1},b.forEach(c,function(a,b){g[b]=new f(a)}),b.documentOn("keydown",function(a){var c=a.keyCode,f=d[c],h=b.pushUnique(e,c),i=g[f];if(i){var j=i.cachedKeypressEvent||{};(j.ctrlKey||j.shiftKey||j.metaKey)&&(h=!0),h&&i.press(null,a)}}),b.documentOn("keyup",function(a){var c=b.removeValue(e,a.keyCode),f=d[c];f&&g[f].up(null,a)}),b.documentOn("blur",function(a){b.forEach(e,function(a){var b=d[a];b&&g[b].up()}),e.length=0}),g}(e);"object"==typeof module&&"object"==typeof module.exports?module.exports=g:"function"==typeof define&&define.amd?define(function(){return g}):a.kd=g}(window);